---
import { Image } from "astro:assets";
import "../styles/global.css";
import SwitchTheme from "../components/SwitchTheme.astro";
import SwitchLang from "../components/SwitchLang.astro";
import LogoImage from "../assets/images/github-organization-logo.png";
// 这里可以导入其他组件或者数据
const { lang, theme } = Astro.props;
---

<!doctype html>
<html lang={lang} data-theme={theme}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TechTalk Hub - Landing Page</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      rel="stylesheet"
    />
    <!-- 不知道为什么要加这个 -->
    <style is:global>
      /* 平滑滚动 */
      html {
        scroll-behavior: smooth;
      }

      /* 深色模式样式 */
      html[data-theme="dark"] {
        --bg-color: #1a202c;
        --text-color: #e2e8f0;
        --card-bg: #2d3748;
        --menu-bg: #2d3748;
        --menu-text: #e2e8f0;
      }

      /* 浅色模式样式 */
      html[data-theme="light"] {
        --bg-color: #ffffff;
        --text-color: #2d3748;
        --card-bg: #edf2f7;
        --menu-bg: #ffffff;
        --menu-text: #2d3748;
      }

      body {
        /* background-color: var(--bg-color); */
        color: var(--text-color);
      }

      .card {
        background-color: var(--card-bg);
      }

      .code-copy-button {
        position: absolute;
        top: 0.5em;
        right: 0.5em;
        background-color: #4a5568;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 0.25rem 0.5rem;
        font-size: 0.8rem;
        cursor: pointer;
        opacity: 0.7;
        transition: opacity 0.2s;
      }

      .code-copy-button:hover {
        opacity: 1;
      }

      pre {
        position: relative;
      }
    </style>
  </head>
  <body class="grid grid-rows-[min-content_1fr_min-content] min-h-screen bg-white dark:bg-gray-900 transition-[background-color]">
    <!-- 导航栏 -->
    <nav class="sticky top-0 bg-white dark:bg-gray-800 transition-[background-color] z-10">
      <div
        class="container mx-auto px-4 py-3 flex justify-between items-center"
      >
        <a
          href="/"
          class="flex gap-2 items-center text-xl font-bold"
        >
          <Image class="w-8 h-8 rounded bg-gray-800 dark:bg-slate-50 p-1" src={LogoImage} alt="Logo" />
          <!-- <img src={LogoImage} /> -->
          <span 
            data-lang-en="TechTalk Hub"
            data-lang-zh="技术交流中心">
            {lang === "en" ? "TechTalk Hub" : "技术交流中心"}
          </span>
        </a>
        <div class="flex items-center space-x-4">
          <!-- 语言切换下拉菜单 -->
          <SwitchLang lang={lang}></SwitchLang>

          <!-- 主题切换按钮 -->
          <SwitchTheme theme={theme}></SwitchTheme>
        </div>
      </div>
    </nav>

    <main>
      <slot></slot>
    </main>

    <!-- 页脚 -->
    <footer class="py-8">
      <div class="container mx-auto px-4 text-center">
        <p
          data-lang-en="© 2025 TechTalk Hub. All rights reserved."
          data-lang-zh="© 2025 技术交流中心。保留所有权利。"
        >
          {
            lang === "en"
              ? "&copy; 2025 TechTalk Hub. All rights reserved."
              : "&copy; 2025 技术交流中心。保留所有权利。"
          }
        </p>
      </div>
    </footer>

    <script>
      // 等待页面加载完成
      document.addEventListener('DOMContentLoaded', () => {
        // 获取所有代码块
        const codeBlocks = Array.from(document.querySelectorAll('pre'));
        
        // 为每个代码块添加复制按钮
        codeBlocks.forEach((pre) => {
          // 创建复制按钮
          const copyButton = document.createElement('button');
          copyButton.className = 'code-copy-button';
          copyButton.innerText = '复制';
          
          // 将按钮添加到代码块中
          pre.appendChild(copyButton);
          
          // 添加点击事件
          copyButton.addEventListener('click', async () => {
            // 获取代码内容
            const code = pre.querySelector('code')?.innerText || pre.innerText;
            
            try {
              // 复制到剪贴板
              await navigator.clipboard.writeText(code);
              
              // 显示复制成功的反馈
              copyButton.innerText = '已复制!';
              
              // 恢复原始文本
              setTimeout(() => {
                copyButton.innerText = '复制';
              }, 2000);
            } catch (err) {
              console.error('复制失败:', err);
              copyButton.innerText = '复制失败';
              
              setTimeout(() => {
                copyButton.innerText = '复制';
              }, 2000);
            }
          });
        });
      });
    </script>
  </body>
</html>
